pipeline {
	agent { 
		docker { 
			image 'grafana/k6:latest'
			args "--entrypoint=''"
		}
	}
	options { ansiColor('xterm') }
	stages {
		stage("check k6") {
			steps {
				sh 'k6 version'
			}
		}
		stage("run k6 test") {
			steps {
				sh 'k6 run --vus 10 --duration 30s --out influxdb=http://inflfuxdb:8086/k6 stress-test.js'
			}
		}
	}
}